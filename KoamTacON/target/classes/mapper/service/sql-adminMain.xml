<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.aisolution.koamtacon.mapper.service.AdminMainMapper">
    <select id="getNumberOfUsers" resultType="HashMap">
    <![CDATA[
        select MAX(day_users) AS dayUsers
             , MAX(week_users) AS weekUsers
             , MAX(month_users) AS monthUsers
          from (select COUNT(0) as day_users
                     , 0 as week_users
                     , 0 as month_users
                  from tb_user
                 where 1=1
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d')
                 union all
                select 0 as day_users
                     , COUNT(0) as week_users
                     , 0 as month_users
                  from tb_user
                 where 1=1
                   and DATE_FORMAT(created_date, '%Y%m%d')  > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 DAY), '%Y%m%d')
                 union all
                select 0 as day_users
                     , 0 as week_users
                     , COUNT(0) as month_users
                  from tb_user
                 where 1=1
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 MONTH), '%Y%m%d')
               ) base
    ]]>
    </select>
    
    <select id="getNumberOfGroups" resultType="HashMap">
    <![CDATA[
        select MAX(day_groups) AS dayGroups
             , MAX(week_groups) AS weekGroups
             , MAX(month_groups) AS monthGroups
          from (select COUNT(0) as day_groups
                     , 0 as week_groups
                     , 0 as month_groups
                  from tb_group
                 where 1=1
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d')
                 union all
                select 0 as day_groups
                     , COUNT(0) as week_groups
                     , 0 as month_groups
                  from tb_group
                 where 1=1
                   and DATE_FORMAT(created_date, '%Y%m%d')  > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 DAY), '%Y%m%d')
                 union all
                select 0 as day_groups
                     , 0 as week_groups
                     , COUNT(0) as month_groups
                  from tb_group
                 where 1=1
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 MONTH), '%Y%m%d')
               ) base
    ]]>
    </select>
    
    <select id="getNumberOfKDC" resultType="HashMap">
    <![CDATA[
        select MAX(day_kdc) AS dayKdc
             , MAX(week_kdc) AS weekKdc
             , MAX(month_kdc) AS monthKdc
          from (select COUNT(0) as day_kdc
                     , 0 as week_kdc
                     , 0 as month_kdc
                  from tb_kdc_registration
                 where 1=1
                   and approval = '0'
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d')
                 union all
                select 0 as day_kdc
                     , COUNT(0) as week_kdc
                     , 0 as month_kdc
                  from tb_kdc_registration
                 where 1=1
                   and approval = '0'
                   and DATE_FORMAT(created_date, '%Y%m%d')  > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 DAY), '%Y%m%d')
                 union all
                select 0 as day_kdc
                     , 0 as week_kdc
                     , COUNT(0) as month_kdc
                  from tb_kdc_registration
                 where 1=1
                   and approval = '0'
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 MONTH), '%Y%m%d')
               ) base
    ]]>
    </select>
    
    <select id="getNumberOfQuestions" resultType="HashMap">
    <![CDATA[
        select MAX(day_questions) AS dayQuestions
             , MAX(week_questions) AS weekQuestions
             , MAX(month_questions) AS monthQuestions
          from (select COUNT(0) as day_questions
                     , 0 as week_questions
                     , 0 as month_questions
                  from tb_board
                 where 1=1
                   and board_type = '02'
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d')
                 union all
                select 0 as day_questions
                     , COUNT(0) as week_questions
                     , 0 as month_questions
                  from tb_board
                 where 1=1
                   and board_type = '02'
                   and DATE_FORMAT(created_date, '%Y%m%d')  > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 DAY), '%Y%m%d')
                 union all
                select 0 as day_questions
                     , 0 as week_questions
                     , COUNT(0) as month_questions
                  from tb_board
                 where 1=1
                   and board_type = '02'
                   and DATE_FORMAT(created_date, '%Y%m%d') > DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 MONTH), '%Y%m%d')
               ) base
    ]]>
    </select>
</mapper>